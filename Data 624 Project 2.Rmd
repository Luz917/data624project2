---
title: "Data 624 Project 2"
author: "Maryluz Cruz, Bill Stepniak, Sherranette Tinapunan"
date: "5/11/2021"
output:
  html_document:
    df_print: paged
  pdf_document: default
  word_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r message=FALSE, warning=FALSE}
library(DataExplorer)
library(ggplot2)
library(psych)
library(caret)
library(tidyverse)
```



## Problem Statement

This is role playing. I am your new boss. I am in charge of production at ABC Beverage and you are a team of data scientists reporting to me. My leadership has told me that new regulations are requiring us to understand our manufacturing process, the predictive factors and be able to report to them our predictive model of PH. Please use the historical data set I am providing. Build and report the factors in BOTH a technical and non-technical report. I like to use Word and Excel. Please provide your non-technical report in a business friendly readable document and your predictions in an Excel readable format. The technical report should show clearly the models you tested and how you selected your final approach. Please submit both Rpubs links and .rmd files or other readable formats for technical and non-technical reports. Also submit the excel file showing the prediction of your models for pH.


## Load Data 


```{r}
student_data<-read.csv("https://raw.githubusercontent.com/Luz917/data624project2/master/StudentData.csv")
student_eval<-read.csv("https://raw.githubusercontent.com/Luz917/data624project2/master/StudentEvaluation.csv")
```


```{r}
dim(student_data)
```


### Summary of Student Data

```{r}
summary(student_data)
```

### Summary of Student Evaluation 


```{r}
summary(student_eval)
```


```{r}
colnames(student_data)
```
```{r}
names(student_data)[names(student_data) == "ï..Brand.Code"] <- "Brand.Code"
names(student_eval)[names(student_eval) == "ï..Brand.Code"] <- "Brand.Code"
```

```{r}
colnames(student_data)
```

## Data Exploration

### Density

```{r}
plot_density(student_data)
```


## Pairs-Plot

```{r fig.height=8, fig.width=10}
pairs.panels(student_data[1:13])
```

```{r fig.height=8, fig.width=10}
pairs.panels(student_data[14:23])
```

```{r fig.height=8, fig.width=10}
pairs.panels(student_data[24:33])
```

### Box Plot


```{r fig.height=10, fig.width=10, message=FALSE, warning=FALSE}
ggplot(stack(student_data), aes(x= ind, y = values)) + 
  geom_boxplot(outlier.colour="green", outlier.shape=1, outlier.size=2,aes(fill=ind)) +
  theme_minimal()+
  coord_flip() 
```






### Missing Data 

```{r fig.height=5}
plot_missing(student_data)
```



## Data Preparation 

### Prepare and Create Dummy Variables of Brand.Code

```{r}
# student_data
Brand.A <- ifelse(student_data$Brand.Code  == 'A', 1, 0)
Brand.B <- ifelse(student_data$Brand.Code  == 'B', 1, 0)
Brand.C <- ifelse(student_data$Brand.Code  == 'C', 1, 0)
Brand.D <- ifelse(student_data$Brand.Code  == 'D', 1, 0)
student_data <- subset(student_data, select = -c(Brand.Code))

# student_eval
Brand.A.t <- ifelse(student_eval$Brand.Code  == 'A', 1, 0)
Brand.B.t <- ifelse(student_eval$Brand.Code  == 'B', 1, 0)
Brand.C.t <- ifelse(student_eval$Brand.Code == 'C', 1, 0)
Brand.D.t <- ifelse(student_eval$Brand.Code  == 'D', 1, 0)
student_eval <- subset(student_eval, select = -c(Brand.Code))


# create dummy columns 
student_data$Brand.A <- Brand.A
student_data$Brand.B <- Brand.B
student_data$Brand.C <- Brand.C
student_data$Brand.D <- Brand.D

student_eval$Brand.A <- Brand.A.t
student_eval$Brand.B <- Brand.B.t
student_eval$Brand.C <- Brand.C.t
student_eval$Brand.D <- Brand.D.t
```


Impute Data and Deal with Normality and NearZero 

```{r}
# pre-processing - combine all steps
prep <- preProcess(student_data, 
                   method = c("knnImpute", "center", "scale", "nzv"), k = 10)

student_data_imp <- predict(prep, student_data)
student_eval <- predict(prep, student_eval)
```


```{r}
# Train set
highcor = findCorrelation(cor(student_data_imp), 0.85)

student_data_imp = student_data_imp[, -highcor]
```

  

## Build Models   
  

### Split Train and Test Data 

```{r}
# Create training and testing split from training data
set.seed(525)
trainrow = createDataPartition(student_data_imp$PH, p = 0.70, list = FALSE)
train_x = student_data_imp[trainrow, ] %>% select(-PH)
train_Y = student_data_imp$PH[trainrow]
test_X = student_data_imp[-trainrow, ] %>% select(-PH)
test_Y = student_data_imp$PH[-trainrow]
```

























